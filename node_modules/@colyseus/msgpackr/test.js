import { Packr } from "./index.js";

const buffer = Buffer.allocUnsafe(512);

const packr = new Packr();
packr.useBuffer(buffer);

function write() {
  buffer[0] = 0; // ... write my own first bytes

  const packedData = packr.pack({ message: "hello world" }, 2048 + 1); // pack data following bytes on existing buffer
  console.log(packedData)

  // get subarray of initial bytes + msgpack encoded
  console.log(Array.from(buffer.subarray(0, packedData.byteLength)))
}


for (let i=0;i<10;i++) {
  write();
}
